function y = mhd(x)
y = zeros(1,size(x,1)*4);
for i = 1 : size(x,1)
    m = x(i,:);
    n = zeros(1,16);
    l = [0 0 0 0 0 0 0;
         0 0 0 1 0 1 1;
         0 0 1 0 1 0 1;
         0 0 1 1 1 1 0;
         0 1 0 0 1 1 0;
         0 1 0 1 1 0 1;
         0 1 1 0 0 1 1;
         0 1 1 1 0 0 0;
         1 0 0 0 1 1 1;
         1 0 0 1 1 0 0;
         1 0 1 0 0 1 0;
         1 0 1 1 0 0 1;
         1 1 0 0 0 0 1;
         1 1 0 1 0 1 0;
         1 1 1 0 1 0 0;
         1 1 1 1 1 1 1];
    for j = 1 : 16
        n(j) = sum(abs(m - l(j,:)));
    end
    k = find(n == min(n));
    switch k(1)
        case 1
            y(4*i-3:4*i) = [0 0 0 0];
        case 2
            y(4*i-3:4*i) = [0 0 0 1];
        case 3
            y(4*i-3:4*i) = [0 0 1 0];
        case 4
            y(4*i-3:4*i) = [0 0 1 1];
        case 5
            y(4*i-3:4*i) = [0 1 0 0];
        case 6
            y(4*i-3:4*i) = [0 1 0 1];
        case 7
            y(4*i-3:4*i) = [0 1 1 0];
        case 8
            y(4*i-3:4*i) = [0 1 1 1];
        case 9
            y(4*i-3:4*i) = [1 0 0 0];
        case 10
            y(4*i-3:4*i) = [1 0 0 1];
        case 11
            y(4*i-3:4*i) = [1 0 1 0];
        case 12
            y(4*i-3:4*i) = [1 0 1 1];
        case 13
            y(4*i-3:4*i) = [1 1 0 0];
        case 14
            y(4*i-3:4*i) = [1 1 0 1];
        case 15
            y(4*i-3:4*i) = [1 1 1 0];
        case 16
            y(4*i-3:4*i) = [1 1 1 1];
    end
end

    